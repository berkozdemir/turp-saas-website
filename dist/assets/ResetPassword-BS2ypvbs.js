import{j as e}from"./vendor-radix-BuVN2Dma.js";import{r as s}from"./vendor-i18n-CgY0HUJK.js";import{R as v,D as k,H as z,b as S}from"./index-DWnt3TQw.js";import"./vendor-react-labSKdyf.js";import"./vendor-utils-jbG8BFt3.js";const G=({token:l,setView:i})=>{const[f,h]=s.useState(!0),[b,p]=s.useState(!1),[o,t]=s.useState(""),[n,y]=s.useState(""),[x,j]=s.useState(""),[c,u]=s.useState(!1),[g,N]=s.useState(!1),d="/api";s.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${d}/admin_auth.php?action=verify-reset-token&token=${l}`)).json();r.valid?p(!0):t(r.error||"Token geçersiz")}catch{t("Bağlantı hatası oluştu")}finally{h(!1)}})()},[l,d]);const w=async a=>{if(a.preventDefault(),t(""),n.length<8){t("Şifre en az 8 karakter olmalıdır");return}if(n!==x){t("Şifreler eşleşmiyor");return}u(!0);try{const r=await(await fetch(`${d}/admin_auth.php?action=reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:l,new_password:n})})).json();r.error?t(r.error):r.success&&(N(!0),setTimeout(()=>{i("admin")},3e3))}catch{t("Bağlantı hatası oluştu")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-cyan-50 via-blue-50 to-slate-100 flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-2xl p-8",children:f?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Token doğrulanıyor..."})]}):b?g?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(k,{size:32,className:"text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Şifre Başarıyla Güncellendi!"}),e.jsx("p",{className:"text-slate-600 mb-4",children:"Yeni şifrenizle giriş yapabilirsiniz."}),e.jsx("p",{className:"text-sm text-slate-500",children:"Giriş sayfasına yönlendiriliyorsunuz..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-cyan-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(z,{size:32,className:"text-cyan-600"})}),e.jsx("h2",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Yeni Şifre Oluştur"}),e.jsx("p",{className:"text-slate-600",children:"Hesabınız için güvenli bir şifre belirleyin"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Yeni Şifre"}),e.jsx("input",{type:"password",value:n,onChange:a=>y(a.target.value),className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:ring focus:ring-cyan-200 transition-all outline-none",placeholder:"En az 8 karakter",required:!0,minLength:8}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Minimum 8 karakter uzunluğunda olmalı"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Şifre Tekrar"}),e.jsx("input",{type:"password",value:x,onChange:a=>j(a.target.value),className:"w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-500 focus:ring focus:ring-cyan-200 transition-all outline-none",placeholder:"Şifreyi tekrar girin",required:!0})]}),o&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o}),e.jsxs("button",{type:"submit",disabled:c,className:"w-full bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-700 hover:to-blue-700 text-white font-semibold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[c?"Şifre güncelleniyor...":"Şifreyi Sıfırla",!c&&e.jsx(S,{size:20})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>i("admin"),className:"text-sm text-cyan-600 hover:text-cyan-700 font-medium",children:"← Giriş ekranına dön"})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(v,{size:32,className:"text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Token Geçersiz"}),e.jsx("p",{className:"text-slate-600 mb-8",children:o}),e.jsx("button",{onClick:()=>i("admin"),className:"text-cyan-600 hover:text-cyan-700 font-medium",children:"← Giriş ekranına dön"})]})})})};export{G as ResetPassword};
